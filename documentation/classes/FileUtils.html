<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>cesiumhdb documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">cesiumhdb documentation</a>
            <button type="button" class="btn btn-default btn-menu fa fa-bars" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
            <div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>
            <nav>

    <ul class="list">

        <li class="title">
            <a href="index.html" data-type="index-link">cesiumhdb documentation</a>
        </li>

        <li class="divider"></li>


        <li class="chapter">
            <a data-type="chapter-link" href="index.html"><span class="fa fa-home"></span>Getting started</a>
            <ul class="links">
                    <li class="link">
                        <a 
                            
                             href="overview.html" 
                             href="overview.html" 
                            data-type="chapter-link">
                            <span class="fa fa-fw fa-th"></span>Overview
                        </a>
                    </li>
                    <li class="link">
                      <a href="index.html" data-type="chapter-link"><span class="fa fa-file-text-o"></span>README</a>
                    </li>
                    <li class="link">
                            <a href="license.html"
                        data-type="chapter-link">
                            <span class="fa fa-fw fa-file-text-o"></span>LICENSE
                        </a>
                    </li>
                    <li class="link">
                        <a href="dependencies.html"
                            data-type="chapter-link">
                            <span class="fa fa-fw fa-list"></span>Dependencies
                        </a>
                    </li>
            </ul>
        </li>


        <li class="chapter modules">
            <a data-type="chapter-link" href="modules.html">
                <div class="menu-toggler linked" data-toggle="collapse"
                        data-target="#xs-modules-links"
                >
                    <span class="fa fa-fw fa-archive"></span>
                    <span class="link-name">Modules</span>
                    <span class="fa fa-angle-down"></span>
                </div>
            </a>
            <ul class="links collapse"
                    id="xs-modules-links"
                >
                    <li class="link">
                        <a href="modules/AppModule.html" data-type="entity-link">AppModule</a>
                            <li class="chapter inner">
                                <div class="simple menu-toggler" data-toggle="collapse"
                                        data-target="#xs-components-links-module-AppModule-3635c68037a3d9e33b2ca07a3c6fbb16"
                                    >
                                    <span class="fa fa-fw fa-cogs"></span>
                                    <span>Components</span>
                                    <span class="fa fa-angle-down"></span>
                                </div>
                                <ul class="links collapse"
                                        id="xs-components-links-module-AppModule-3635c68037a3d9e33b2ca07a3c6fbb16"
                                    >
                                        <li class="link">
                                            <a href="components/AppComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">AppComponent</a>
                                        </li>
                                </ul>
                            </li>
                    </li>
                    <li class="link">
                        <a href="modules/MobiusCesium.html" data-type="entity-link">MobiusCesium</a>
                            <li class="chapter inner">
                                <div class="simple menu-toggler" data-toggle="collapse"
                                        data-target="#xs-components-links-module-MobiusCesium-3abc4dfbdf5d9e36ec6b433260911949"
                                    >
                                    <span class="fa fa-fw fa-cogs"></span>
                                    <span>Components</span>
                                    <span class="fa fa-angle-down"></span>
                                </div>
                                <ul class="links collapse"
                                        id="xs-components-links-module-MobiusCesium-3abc4dfbdf5d9e36ec6b433260911949"
                                    >
                                        <li class="link">
                                            <a href="components/DataComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">DataComponent</a>
                                        </li>
                                        <li class="link">
                                            <a href="components/DisplayComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">DisplayComponent</a>
                                        </li>
                                        <li class="link">
                                            <a href="components/MobiuscesiumComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">MobiuscesiumComponent</a>
                                        </li>
                                        <li class="link">
                                            <a href="components/PublishComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">PublishComponent</a>
                                        </li>
                                        <li class="link">
                                            <a href="components/SelectComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">SelectComponent</a>
                                        </li>
                                        <li class="link">
                                            <a href="components/SettingComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">SettingComponent</a>
                                        </li>
                                        <li class="link">
                                            <a href="components/ViewerComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">ViewerComponent</a>
                                        </li>
                                </ul>
                            </li>
                            <li class="chapter inner">
                                <div class="simple menu-toggler" data-toggle="collapse"
                                        data-target="#xs-injectables-links-module-MobiusCesium-3abc4dfbdf5d9e36ec6b433260911949"
                                    >
                                    <span class="fa fa-fw fa-long-arrow-down"></span>
                                    <span>Injectables</span>
                                    <span class="fa fa-angle-down"></span>
                                </div>
                                <ul class="links collapse"
                                        id="xs-injectables-links-module-MobiusCesium-3abc4dfbdf5d9e36ec6b433260911949"
                                    >
                                        <li class="link">
                                            <a href="injectables/DataService.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules"}>DataService</a>
                                        </li>
                                </ul>
                            </li>
                    </li>
            </ul>
        </li>



        <li class="chapter">
            <div class="simple menu-toggler" data-toggle="collapse"
                    data-target="#xs-classes-links"
                >
                <span class="fa fa-fw fa-file-code-o"></span>
                <span>Classes</span>
                <span class="fa fa-angle-down"></span>
            </div>
            <ul class="links collapse"
                    id="xs-classes-links"
                >
                    <li class="link">
                        <a href="classes/DataSubscriber.html" data-type="entity-link">DataSubscriber</a>
                    </li>
                    <li class="link">
                        <a href="classes/FileUtils.html" data-type="entity-link">FileUtils</a>
                    </li>
            </ul>
        </li>

                <li class="chapter">
                    <div class="simple menu-toggler" data-toggle="collapse"
                            data-target="#xs-injectables-links"
                        >
                        <span class="fa fa-fw fa-long-arrow-down"></span>
                        <span>Injectables</span>
                        <span class="fa fa-angle-down"></span>
                    </div>
                    <ul class="links collapse"
                            id="xs-injectables-links"
                        >
                            <li class="link">
                                <a href="injectables/DataService.html" data-type="entity-link">DataService</a>
                            </li>
                    </ul>
                </li>




        <li class="chapter">
            <div class="simple menu-toggler" data-toggle="collapse"
                    data-target="#xs-miscellaneous-links"
                >
                <span class="fa fa-fw fa-cubes"></span>
                <span>Miscellaneous</span>
                <span class="fa fa-angle-down"></span>
            </div>
            <ul class="links collapse"
                    id="xs-miscellaneous-links"
                >
                    <li class="link">
                      <a href="miscellaneous/variables.html" data-type="entity-link">Variables</a>
                    </li>
            </ul>
        </li>


        <li class="chapter">
            <a data-type="chapter-link" href="coverage.html"><span class="fa fa-fw fa-tasks"></span>Documentation coverage</a>
        </li>

        <li class="divider"></li>
        <li class="copyright">
                Documentation generated using <a href="https://compodoc.github.io/website/" target="_blank">
                            <img data-src="images/compodoc-vectorise.svg" class="img-responsive" data-type="compodoc-logo">
                </a>
        </li>

    </ul>

</nav>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <nav>

    <ul class="list">

        <li class="title">
            <a href="index.html" data-type="index-link">cesiumhdb documentation</a>
        </li>

        <li class="divider"></li>

            <div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>

        <li class="chapter">
            <a data-type="chapter-link" href="index.html"><span class="fa fa-home"></span>Getting started</a>
            <ul class="links">
                    <li class="link">
                        <a 
                            
                             href="overview.html" 
                             href="overview.html" 
                            data-type="chapter-link">
                            <span class="fa fa-fw fa-th"></span>Overview
                        </a>
                    </li>
                    <li class="link">
                      <a href="index.html" data-type="chapter-link"><span class="fa fa-file-text-o"></span>README</a>
                    </li>
                    <li class="link">
                            <a href="license.html"
                        data-type="chapter-link">
                            <span class="fa fa-fw fa-file-text-o"></span>LICENSE
                        </a>
                    </li>
                    <li class="link">
                        <a href="dependencies.html"
                            data-type="chapter-link">
                            <span class="fa fa-fw fa-list"></span>Dependencies
                        </a>
                    </li>
            </ul>
        </li>


        <li class="chapter modules">
            <a data-type="chapter-link" href="modules.html">
                <div class="menu-toggler linked" data-toggle="collapse"
                        data-target="#modules-links"
                >
                    <span class="fa fa-fw fa-archive"></span>
                    <span class="link-name">Modules</span>
                    <span class="fa fa-angle-down"></span>
                </div>
            </a>
            <ul class="links collapse"
                    id="modules-links"
>
                    <li class="link">
                        <a href="modules/AppModule.html" data-type="entity-link">AppModule</a>
                            <li class="chapter inner">
                                <div class="simple menu-toggler" data-toggle="collapse"
                                        data-target="#components-links-module-AppModule-3635c68037a3d9e33b2ca07a3c6fbb16"
>
                                    <span class="fa fa-fw fa-cogs"></span>
                                    <span>Components</span>
                                    <span class="fa fa-angle-down"></span>
                                </div>
                                <ul class="links collapse"
                                        id="components-links-module-AppModule-3635c68037a3d9e33b2ca07a3c6fbb16"
>
                                        <li class="link">
                                            <a href="components/AppComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">AppComponent</a>
                                        </li>
                                </ul>
                            </li>
                    </li>
                    <li class="link">
                        <a href="modules/MobiusCesium.html" data-type="entity-link">MobiusCesium</a>
                            <li class="chapter inner">
                                <div class="simple menu-toggler" data-toggle="collapse"
                                        data-target="#components-links-module-MobiusCesium-3abc4dfbdf5d9e36ec6b433260911949"
>
                                    <span class="fa fa-fw fa-cogs"></span>
                                    <span>Components</span>
                                    <span class="fa fa-angle-down"></span>
                                </div>
                                <ul class="links collapse"
                                        id="components-links-module-MobiusCesium-3abc4dfbdf5d9e36ec6b433260911949"
>
                                        <li class="link">
                                            <a href="components/DataComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">DataComponent</a>
                                        </li>
                                        <li class="link">
                                            <a href="components/DisplayComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">DisplayComponent</a>
                                        </li>
                                        <li class="link">
                                            <a href="components/MobiuscesiumComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">MobiuscesiumComponent</a>
                                        </li>
                                        <li class="link">
                                            <a href="components/PublishComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">PublishComponent</a>
                                        </li>
                                        <li class="link">
                                            <a href="components/SelectComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">SelectComponent</a>
                                        </li>
                                        <li class="link">
                                            <a href="components/SettingComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">SettingComponent</a>
                                        </li>
                                        <li class="link">
                                            <a href="components/ViewerComponent.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules">ViewerComponent</a>
                                        </li>
                                </ul>
                            </li>
                            <li class="chapter inner">
                                <div class="simple menu-toggler" data-toggle="collapse"
                                        data-target="#injectables-links-module-MobiusCesium-3abc4dfbdf5d9e36ec6b433260911949"
>
                                    <span class="fa fa-fw fa-long-arrow-down"></span>
                                    <span>Injectables</span>
                                    <span class="fa fa-angle-down"></span>
                                </div>
                                <ul class="links collapse"
                                        id="injectables-links-module-MobiusCesium-3abc4dfbdf5d9e36ec6b433260911949"
>
                                        <li class="link">
                                            <a href="injectables/DataService.html" data-type="entity-link" data-context="sub-entity" data-context-id="modules"}>DataService</a>
                                        </li>
                                </ul>
                            </li>
                    </li>
            </ul>
        </li>



        <li class="chapter">
            <div class="simple menu-toggler" data-toggle="collapse"
                    data-target="#classes-links"
>
                <span class="fa fa-fw fa-file-code-o"></span>
                <span>Classes</span>
                <span class="fa fa-angle-down"></span>
            </div>
            <ul class="links collapse"
                    id="classes-links"
>
                    <li class="link">
                        <a href="classes/DataSubscriber.html" data-type="entity-link">DataSubscriber</a>
                    </li>
                    <li class="link">
                        <a href="classes/FileUtils.html" data-type="entity-link">FileUtils</a>
                    </li>
            </ul>
        </li>

                <li class="chapter">
                    <div class="simple menu-toggler" data-toggle="collapse"
                            data-target="#injectables-links"
>
                        <span class="fa fa-fw fa-long-arrow-down"></span>
                        <span>Injectables</span>
                        <span class="fa fa-angle-down"></span>
                    </div>
                    <ul class="links collapse"
                            id="injectables-links"
>
                            <li class="link">
                                <a href="injectables/DataService.html" data-type="entity-link">DataService</a>
                            </li>
                    </ul>
                </li>




        <li class="chapter">
            <div class="simple menu-toggler" data-toggle="collapse"
                    data-target="#miscellaneous-links"
>
                <span class="fa fa-fw fa-cubes"></span>
                <span>Miscellaneous</span>
                <span class="fa fa-angle-down"></span>
            </div>
            <ul class="links collapse"
                    id="miscellaneous-links"
>
                    <li class="link">
                      <a href="miscellaneous/variables.html" data-type="entity-link">Variables</a>
                    </li>
            </ul>
        </li>


        <li class="chapter">
            <a data-type="chapter-link" href="coverage.html"><span class="fa fa-fw fa-tasks"></span>Documentation coverage</a>
        </li>

        <li class="divider"></li>
        <li class="copyright">
                Documentation generated using <a href="https://compodoc.github.io/website/" target="_blank">
                            <img data-src="images/compodoc-vectorise.svg" class="img-responsive" data-type="compodoc-logo">
                </a>
        </li>

    </ul>

</nav>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">









<ol class="breadcrumb">
  <li>Classes</li>
  <li>FileUtils</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/mobius-cesium/viewer/viewer.component.ts</code>
        </p>





            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Static</span>
                                <a href="#downloadContent">downloadContent</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>



            <section>
    
        <h3 id="methods">
            Methods
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="downloadContent"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Static</span>
                            downloadContent
                            </b>
                            <a href="#downloadContent"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                            <span class="modifier-icon fa fa-reset"></span>
                        <code>downloadContent(blob: , filename: )</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="388" class="link-to-prism">src/app/mobius-cesium/viewer/viewer.component.ts:388</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">

                            <div class="io-description">
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>blob</td>
                                                    
                                                    <td>
                                                            no
                                                    </td>
                                                    

                                                </tr>
                                                <tr>
                                                        <td>filename</td>
                                                    
                                                    <td>
                                                            no
                                                    </td>
                                                    

                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                                <div class="io-description">
                                    
                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>






    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, OnInit, Injector, ElementRef } from &quot;@angular/core&quot;;
import {DataSubscriber} from &quot;../data/DataSubscriber&quot;;
import {SettingComponent} from &quot;../setting/setting.component&quot;;
// import * as d3 from &quot;d3-array&quot;;
import * as chroma from &quot;chroma-js&quot;;

@Component({
  selector: &quot;cesium-viewer&quot;,
  templateUrl: &quot;./viewer.component.html&quot;,
  styleUrls: [&quot;./viewer.component.css&quot;],
})
export class ViewerComponent extends DataSubscriber {
  private data: JSON;
  private myElement;
  private dataArr: object;
  private viewer: any;
  private selectEntity: any&#x3D;null;
  private material: object;
  private _Colorbar: any[];
  private texts: any[];
  private _Cattexts: any[];
  private _CatNumtexts: any[];
  private pickupArrs: any[];
  private mode: string;
  private _index: number;
  private _ShowColorBar: boolean;
  private _ColorKey: string;
  private _ExtrudeKey: string;

  constructor(injector: Injector, myElement: ElementRef) {
    super(injector);
    this.myElement &#x3D; myElement;
  }

  public ngOnInit() {
    //pass mode to dataService
    this.mode &#x3D; this.dataService.getmode();
    if(this.dataService.getViewer() &#x3D;&#x3D;&#x3D; undefined){
      this.CreateViewer();
    }
    //pass data to dataService
    this.data &#x3D; this.dataService.getGsModel();
    //load data
    this.LoadData(this.data);
  }

  public notify(message: string): void {
    if(message &#x3D;&#x3D;&#x3D; &quot;model_update&quot; ) {
      this.data &#x3D; this.dataService.getGsModel();
      try {
        if(this.dataService.getViewer() &#x3D;&#x3D;&#x3D; undefined){
          this.CreateViewer();
        }
        this.LoadData(this.data);
      }
      catch(ex) {
        console.log(ex);
      }
    }
  }
  //create cesium viewer and change home button funciton
  public CreateViewer(){
    const viewer &#x3D; new Cesium.Viewer(&quot;cesiumContainer&quot; , {
      infoBox: false,
      showRenderLoopErrors: false,
      orderIndependentTranslucency: false,
      baseLayerPicker: false,
      fullscreenButton:false,
      automaticallyTrackDataSourceClocks:false,
      animation:false,
      shadows:true,
      scene3DOnly:true,
    });
    viewer.scene.imageryLayers.removeAll();
    viewer.scene.globe.baseColor &#x3D; Cesium.Color.GRAY;
    document.getElementsByClassName(&quot;cesium-viewer-bottom&quot;)[0].remove();
    const self &#x3D; this;
    viewer.homeButton.viewModel.command.beforeExecute.addEventListener(function(e) {
        e.cancel &#x3D; true;
        viewer.zoomTo(self.dataService.getcesiumpromise());
    });
    this.dataService.setViewer(viewer);
  }
  //Cesium geoJson to load data and check mode
  public LoadData(data: JSON) {
    if(this.data !&#x3D;&#x3D; undefined) {
      
      //get viewer from dataService and remove the last dataSources
      const viewer &#x3D; this.dataService.getViewer();
      viewer.dataSources.removeAll({destroy:true}); 

      //load geojson and add geojson to dataSources
      this.data &#x3D; data;
      const promise &#x3D; Cesium.GeoJsonDataSource.load(this.data);
      viewer.dataSources.add(promise);

       //check whether show colorbar or not
      promise.then(function(dataSource) {
        const entities &#x3D; dataSource.entities.values;
        const self &#x3D; this;
        if(entities[0].polygon !&#x3D;&#x3D; undefined) {self._ShowColorBar &#x3D; true;} else {self._ShowColorBar &#x3D; false;}
      });
      

      // pass promise to dataService
      this.dataService.setcesiumpromise(promise);

      //check the mode and load different data
      if(this.mode &#x3D;&#x3D;&#x3D; &quot;editor&quot;) {
        this.dataService.getValue(this.data);
        this.dataService.LoadJSONData();
        this.dataArr &#x3D; this.dataService.get_ViData();
        this._index &#x3D; 1;
      }
      if(this.mode &#x3D;&#x3D;&#x3D; &quot;viewer&quot;) {
        this.dataService.LoadJSONData();
        this.dataArr &#x3D; this.dataService.get_PuData();
        this._index &#x3D; 3;
      }
      viewer.zoomTo(promise);
      this.Colortext();
    }
  }
  //create color bar and text at bottom of viewer
  public Colortext() {
    if(this.dataArr !&#x3D;&#x3D; undefined) {
      if(this._index !&#x3D;&#x3D; this.dataService.get_index()) {
        this._index &#x3D; this.dataService.get_index();
        if(this._index &#x3D;&#x3D;&#x3D; 1) {this.dataArr &#x3D; this.dataService.get_ViData();
        } else if(this._index &#x3D;&#x3D;&#x3D; 3) {this.dataArr &#x3D; this.dataService.get_PuData();}
      }
      const propertyname &#x3D; this.dataArr[&quot;ColorKey&quot;];
      const texts &#x3D; this.dataArr[&quot;ColorText&quot;].sort();
      const _Max: number &#x3D; this.dataArr[&quot;ColorMax&quot;];
      const _Min: number &#x3D; this.dataArr[&quot;ColorMin&quot;];
      if(this.mode &#x3D;&#x3D;&#x3D; &quot;viewer&quot;) {
        this._ColorKey &#x3D; this.dataArr[&quot;ColorKey&quot;];
        this._ExtrudeKey &#x3D; this.dataArr[&quot;ExtrudeKey&quot;];
      }
      this.texts &#x3D; undefined;
      this._Cattexts &#x3D; [];
      this._CatNumtexts &#x3D; [];
      let _ColorKey: any;
      let _ChromaScale &#x3D; chroma.scale(&quot;SPECTRAL&quot;);
      if(this.dataArr[&quot;ColorInvert&quot;] &#x3D;&#x3D;&#x3D; true) {_ChromaScale &#x3D; chroma.scale(&quot;SPECTRAL&quot;).domain([1,0]);}
      this._Colorbar &#x3D; [];
      for(let i &#x3D; 79;i&gt;-1;i--) {
        this._Colorbar.push(_ChromaScale(i/80));
      }
      if(typeof(texts[0]) &#x3D;&#x3D;&#x3D; &quot;number&quot;) {
        this.texts &#x3D; [Number(_Min.toFixed(2))];
        for(let i &#x3D; 1;i&lt;10;i++) {
          this.texts.push(Number((_Min+(_Max-_Min)*(i/10)).toFixed(2)));
        }
        this.texts.push(Number(_Max.toFixed(2)));
        for(let i &#x3D; 0;i&lt;this.texts.length;i++) {
          if(this.texts[i]/1000000000&gt;1) {
            this.texts[i] &#x3D; String(Number((this.texts[i]/1000000000).toFixed(3))).concat(&quot;B&quot;);
          } else if(this.texts[i]/1000000&gt;1) {
            this.texts[i] &#x3D; String(Number((this.texts[i]/1000000).toFixed(3))).concat(&quot;M&quot;);
          } else if(this.texts[i]/1000&gt;1) {
            this.texts[i] &#x3D; String(Number(((this.texts[i]/1000)).toFixed(3))).concat(&quot;K&quot;);
          }
        }
      }
      if(typeof(texts[0]) &#x3D;&#x3D;&#x3D; &quot;string&quot;) {
        if(texts.length&lt;&#x3D;12) {
          for(let j &#x3D; 0;j&lt;texts.length;j++) {
            _ColorKey &#x3D; [];
            _ColorKey.text &#x3D; texts[j];
            _ColorKey.color &#x3D; _ChromaScale (1 - (j / texts.length));
            this._Cattexts.push(_ColorKey);
          }
        } else {
          for(let j &#x3D; 0;j&lt;this._Colorbar.length;j++) {
            _ColorKey &#x3D; [];
            if(j &#x3D;&#x3D;&#x3D; 0) {_ColorKey.text &#x3D; texts[j];} else if(j &#x3D;&#x3D;&#x3D; this._Colorbar.length-1) {
              if(texts[texts.length-1] !&#x3D;&#x3D; null) {_ColorKey.text &#x3D; texts[texts.length-1];
              } else {_ColorKey.text &#x3D; texts[texts.length-2];}
            } else { _ColorKey.text &#x3D; null;}
            _ColorKey.color &#x3D; this._Colorbar[j];
            this._CatNumtexts.push(_ColorKey);
          }
        }
      }
    }
    if(this._ShowColorBar &#x3D;&#x3D;&#x3D; false) {
      this._Cattexts &#x3D; undefined;
      this._Colorbar &#x3D; undefined;
    }
  }
  //click building to select and  pass whole entity to dataService
  public select() {
    event.stopPropagation();
    const viewer &#x3D; this.dataService.getViewer();//this.viewer;
    if(this.dataArr !&#x3D;&#x3D; undefined) {
      if(this.selectEntity !&#x3D;&#x3D; undefined&amp;&amp;this.selectEntity !&#x3D;&#x3D; null) {this.ColorSelect(this.selectEntity);}
      if(viewer.selectedEntity !&#x3D;&#x3D; undefined&amp;&amp;viewer.selectedEntity.polygon !&#x3D;&#x3D; null) {
        this.dataService.set_SelectedEntity(viewer.selectedEntity);
        let material;
        if(viewer.selectedEntity.polygon !&#x3D;&#x3D; undefined) {
          material &#x3D; viewer.selectedEntity.polygon.material;
          viewer.selectedEntity.polygon.material &#x3D; Cesium.Color.WHITE;
        }
        if(viewer.selectedEntity.polyline !&#x3D;&#x3D; undefined) {
          material &#x3D; viewer.selectedEntity.polyline.material;
          viewer.selectedEntity.polyline.material &#x3D; Cesium.Color.WHITE;
        }
        this.selectEntity &#x3D; viewer.selectedEntity;
        this.material &#x3D; material;
      } else {
        this.dataService.set_SelectedEntity(undefined);
        this.selectEntity &#x3D; undefined;
        this.material &#x3D; undefined;
      }
    }
  }
  //if unselect the building, it will show the color before
  public ColorSelect(entity) {
    const promise &#x3D; this.dataService.getcesiumpromise();
    const _ColorKey: string &#x3D; this.dataArr[&quot;ColorKey&quot;];
    const _ColorMax: number &#x3D; this.dataArr[&quot;ColorMax&quot;];
    const _ColorMin: number &#x3D; this.dataArr[&quot;ColorMin&quot;];
    const _ColorText: any[] &#x3D; this.dataArr[&quot;ColorText&quot;];
    const _ColorInvert: boolean &#x3D; this.dataArr[&quot;ColorInvert&quot;];
    const _ExtrudeKey: string &#x3D; this.dataArr[&quot;ExtrudeKey&quot;];
    const _ExtrudeMax: number &#x3D; this.dataArr[&quot;ExtrudeMax&quot;];
    const _ExtrudeMin: number &#x3D; this.dataArr[&quot;ExtrudeMin&quot;];
    const _HeightChart: boolean &#x3D; this.dataArr[&quot;HeightChart&quot;];
    const _Invert: boolean &#x3D; this.dataArr[&quot;Invert&quot;];
    const _Scale: number &#x3D; this.dataArr[&quot;Scale&quot;];
    const _Filter: any[] &#x3D; this.dataArr[&quot;Filter&quot;];
    let _ChromaScale &#x3D; chroma.scale(&quot;SPECTRAL&quot;);
    if(_ColorInvert &#x3D;&#x3D;&#x3D; true) {_ChromaScale &#x3D; chroma.scale(&quot;SPECTRAL&quot;).domain([1,0]);}
    let _CheckHide: boolean;
    if(entity.properties[&quot;TYPE&quot;] &#x3D;&#x3D;&#x3D; undefined||entity.properties[&quot;TYPE&quot;]._value !&#x3D;&#x3D; &quot;STATIC&quot;){
      if(_Filter.length !&#x3D;&#x3D; 0) {
        _CheckHide &#x3D; this.Hide(_Filter,entity,_HeightChart);
        if(_CheckHide &#x3D;&#x3D;&#x3D; true) {
          if(entity.polygon !&#x3D;&#x3D; undefined) {
            entity.polygon.extrudedHeight &#x3D; 0;
            entity.polygon.material &#x3D; Cesium.Color.LIGHTSLATEGRAY.withAlpha(1);
            if(_HeightChart &#x3D;&#x3D;&#x3D; true) {
              if(entity.polyline !&#x3D;&#x3D; undefined) {entity.polyline.show &#x3D; false;}
            }
          }
          if(entity.polyline !&#x3D;&#x3D; undefined)  {entity.polyline.material &#x3D; Cesium.Color.LIGHTSLATEGRAY.withAlpha(1);}
        }
      }
      if(_Filter.length &#x3D;&#x3D;&#x3D; 0||_CheckHide &#x3D;&#x3D;&#x3D; false) {
        if(_ColorKey !&#x3D;&#x3D; &quot;None&quot;) {
          if(typeof(_ColorText[0]) &#x3D;&#x3D;&#x3D; &quot;number&quot;) {
            this.colorByNum(entity,_ColorMax,_ColorMin,_ColorKey,_ChromaScale);
          } else {this.colorByCat(entity,_ColorText,_ColorKey,_ChromaScale);}
        } else {entity.polygon.material &#x3D; Cesium.Color.DARKGREY;}
      }
    }else {
      entity.polygon.height &#x3D;  entity.properties[&quot;HEIGHT&quot;];
      entity.polygon.extrudedHeight &#x3D; entity.properties[&quot;EXTRUHEIGHT&quot;];
      const ColorValue &#x3D; entity.properties[&quot;COLOR&quot;]._value;
      entity.polygon.material &#x3D; Cesium.Color.fromBytes(ColorValue[0], ColorValue[1], ColorValue[2], ColorValue[3]);
    }
  }
  //check the selected building  color before
  public Hide(_Filter: any[], entity, _HeightChart: boolean): boolean {
    let _CheckHide: boolean&#x3D;false;
    for(const filter of _Filter) {
      const value &#x3D; entity.properties[filter.HeightHide]._value;
      if(value !&#x3D;&#x3D; undefined) {
        if(typeof(value) &#x3D;&#x3D;&#x3D; &quot;number&quot;) {
          if (this._compare(value, Number(filter.textHide), Number(filter.RelaHide))) {
            _CheckHide &#x3D; true;
          }
        } else if(typeof(value) &#x3D;&#x3D;&#x3D; &quot;string&quot;) {
          if (this._compareCat(value,filter.CategaryHide, Number(filter.RelaHide))) {
            _CheckHide &#x3D; true;
          }
        }
      }
    }
    return _CheckHide;
  }
  public _compare(value: number, slider: number, relation: number): boolean {
    switch (relation) {
      case 0:
        return value &lt; slider;
      case 1:
        return value &gt; slider;
      case 2:
        return value !&#x3D;&#x3D; slider;
    }
  }
  public _compareCat(value: string, _Categary: string,relation: number): boolean {
    switch (relation) {
      case 0:
        return value &#x3D;&#x3D;&#x3D;  undefined;
      case 1:
        return value !&#x3D;&#x3D; _Categary;
      case 2:
        return value &#x3D;&#x3D;&#x3D; _Categary;
    }
  }
  public colorByNum(entity, max: number, min: number, _ColorKey: string, _ChromaScale: any) {
    if(entity.properties[_ColorKey] !&#x3D;&#x3D; undefined) {
      const texts &#x3D; entity.properties[_ColorKey]._value;
      const rgb &#x3D; _ChromaScale(Number(((max-texts)/(max-min)).toFixed(2)))._rgb;
      if(entity.polygon !&#x3D;&#x3D; undefined) {entity.polygon.material &#x3D; Cesium.Color.fromBytes(rgb[0],rgb[1],rgb[2]);}
      if(entity.polyline !&#x3D;&#x3D; undefined) {
        const newColor &#x3D; new Cesium.Color.fromBytes(rgb[0],rgb[1],rgb[2]);
        entity.polyline.material.color.setValue(newColor);
      }
      if(entity.point !&#x3D;&#x3D;undefined){
        const newColor &#x3D; new Cesium.Color.fromBytes(rgb[0],rgb[1],rgb[2]);
        entity.point.color &#x3D; newColor;
      }
    }else{
      if(entity.polygon !&#x3D;&#x3D; undefined) {entity.polygon.material &#x3D; Cesium.Color.LIGHTSLATEGRAY.withAlpha(1);}
      if(entity.polyline !&#x3D;&#x3D; undefined) {entity.polyline.material &#x3D; Cesium.Color.LIGHTSLATEGRAY.withAlpha(1);}
      if(entity.point !&#x3D;&#x3D; undefined) {entity.point.color &#x3D; Cesium.Color.LIGHTSLATEGRAY.withAlpha(1);}
    }
  }

  public  colorByCat(entity, _ColorText: any[], _ColorKey: string, _ChromaScale: any) {
    if(entity.properties[_ColorKey] !&#x3D;&#x3D; undefined) {
      let initial: boolean &#x3D; false;
      for(let j &#x3D; 0;j&lt;_ColorText.length; j++) {
        if(entity.properties[_ColorKey]._value &#x3D;&#x3D;&#x3D; _ColorText[j]) {
          const rgb &#x3D; _ChromaScale(1 - (j / _ColorText.length)); 
          if(entity.polygon !&#x3D;&#x3D; undefined){entity.polygon.material &#x3D; Cesium.Color.fromBytes(rgb._rgb[0],rgb._rgb[1],rgb._rgb[2]);}
          if(entity.polyline !&#x3D;&#x3D; undefined) {
            const newColor &#x3D; new Cesium.Color.fromBytes(rgb[0],rgb[1],rgb[2]);
            entity.polyline.material.color.setValue(newColor);
          }
          if(entity.point !&#x3D;&#x3D; undefined) {
            const newColor &#x3D; new Cesium.Color.fromBytes(rgb[0],rgb[1],rgb[2]);
            entity.point.color &#x3D; newColor;
          }
          initial &#x3D; true;
        }
      }
      if(initial &#x3D;&#x3D;&#x3D; false) {
        if(entity.polygon !&#x3D;&#x3D; undefined){entity.polygon.material &#x3D; Cesium.Color.LIGHTSLATEGRAY.withAlpha(1);}
        if(entity.polyline !&#x3D;&#x3D; undefined) {entity.polyline.material &#x3D; Cesium.Color.LIGHTSLATEGRAY.withAlpha(1);}
        if(entity.point !&#x3D;&#x3D; undefined) {entity.point.color &#x3D; Cesium.Color.LIGHTSLATEGRAY.withAlpha(1);}
      }
    }else{
      if(entity.polygon !&#x3D;&#x3D; undefined) {entity.polygon.material &#x3D; Cesium.Color.LIGHTSLATEGRAY.withAlpha(1);}
      if(entity.polyline !&#x3D;&#x3D; undefined) {entity.polyline.material &#x3D; Cesium.Color.LIGHTSLATEGRAY.withAlpha(1);}
      if(entity.point !&#x3D;&#x3D; undefined) {entity.point.color &#x3D; Cesium.Color.LIGHTSLATEGRAY.withAlpha(1);}
    }
  }
  //in viewer mode,set some attibutes to show
  public showAttribs(event) {
    const viewer &#x3D; this.dataService.getViewer()
    if(this.data !&#x3D;&#x3D; undefined &amp;&amp; this.mode &#x3D;&#x3D;&#x3D; &quot;viewer&quot;) {
      if(this.data[&quot;cesium&quot;] !&#x3D;&#x3D; undefined) {
        if(this.data[&quot;cesium&quot;].select !&#x3D;&#x3D; undefined) {
          if(viewer.selectedEntity !&#x3D;&#x3D; undefined) {
            const pickup &#x3D; viewer.scene.pick(new Cesium.Cartesian2(event.clientX,event.clientY));
            this.pickupArrs &#x3D; [];
            this.pickupArrs.push({name:&quot;ID&quot;,data:pickup.id.id});
            for(const _propertyName of this.data[&quot;cesium&quot;].select) {
              this.pickupArrs.push({name:_propertyName,data:
                                    this.dataService.get_SelectedEntity().properties[_propertyName]._value});
            }
            const nameOverlay &#x3D; document.getElementById(&quot;cesium-infoBox-defaultTable&quot;);
            viewer.container.appendChild(nameOverlay);
            nameOverlay.style.bottom &#x3D; viewer.canvas.clientHeight - event.clientY + &quot;px&quot;;
            nameOverlay.style.left &#x3D; event.clientX + &quot;px&quot;;
            nameOverlay.style.display&#x3D; &quot;block&quot;;
          } else {
            document.getElementById(&quot;cesium-infoBox-defaultTable&quot;).style.display&#x3D; &quot;none&quot;;
          }
        }
      }
    }
  }
    // save the geojson
  save_geojson(): void{
    let fileString &#x3D; JSON.stringify(this.data);
    let blob &#x3D; new Blob([fileString], {type: &#x27;application/json&#x27;});
    FileUtils.downloadContent(blob, &quot;output.geojson&quot;);
  }
}

//download geojson
abstract class FileUtils{
  public static downloadContent(blob, filename) {
    if (window.navigator.msSaveOrOpenBlob) {
      window.navigator.msSaveOrOpenBlob(blob, filename);
    } else {
        const a &#x3D; document.createElement(&#x27;a&#x27;);
        document.body.appendChild(a);
        const url &#x3D; window.URL.createObjectURL(blob);
        a.href &#x3D; url;
        a.download &#x3D; filename;
        a.click();
        setTimeout(() &#x3D;&gt; {
          window.URL.revokeObjectURL(url);
          document.body.removeChild(a);
        }, 0)
    }
  }
}</code></pre>
    </div>
</div>






                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

        <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'FileUtils.html';
        </script>

       <script src="../js/search/search.js"></script>
       <script src="../js/search/lunr.min.js"></script>
       <script src="../js/search/search-lunr.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
       <script src="../js/search/search_index.js"></script>


    </body>
</html>
